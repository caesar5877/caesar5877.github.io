
Amazon ECS Core Components

---

##  二、ECS 的核心优势
与 AWS 深度集成（Tight Integration）: 无缝对接多种 AWS 服务：CloudWatch（监控）、IAM（访问控制）、ELB（流量分发）、ECR（镜像仓库）、Secrets Manager（密钥管理）等。

##  三、ECS 的两大架构层次

Amazon ECS 的底层架构分为两部分：

###  控制平面（Control Plane）

负责「**调度与编排**」。

* 接收来自用户或工具（如 AWS CLI、API、CDK、Terraform）的指令；
* 决定“要运行什么、运行在哪儿”；
* 管理任务生命周期（启动、停止、替换失败任务）；
* 维护服务发现、任务健康状态等。

###  数据平面（Data Plane）

负责**实际运行容器**。

* 容器运行在 **EC2 实例**、**AWS Fargate** 或 **ECS Anywhere** 节点上；
* 每个计算节点上都有一个 **ECS Agent**；

  * 负责与控制平面保持通信；
  * 执行调度命令（启动/停止容器）；
  * 上报任务与实例状态、健康检查信息。

**交互逻辑：**

 用户下达指令 → 控制平面调度任务 → ECS Agent 在数据平面执行 → 状态同步回控制平面。

---

##  四、三种计算选项（Compute Options）

|                         |                                        |                  |
| ----------------------- | -------------------------------------- | ---------------- |
| **EC2 Launch Type**     | 你管理 EC2 实例：可选实例类型、安装自定义软件、调优性能；完全控制底层主机。 | 对合规性、安全、性能有严格要求的应用。 |
| **AWS Fargate Launch Type** | AWS 全托管的“无服务器”容器运行方式：无需管理实例或容量。        | 想简化运维、专注应用逻辑的团队。 |
| **ECS Anywhere**        | 让本地或混合云服务器注册进 ECS 集群，统一管理容器。           | 需要跨云或本地部署、统一调度的混合环境。 |

 **组合使用：**
ECS 允许同一集群混合 EC2 + Fargate + 外部节点，实现灵活的计算资源编排。

---

##  五、ECS 的三个核心构建块（Core Constructs）

ECS 的“基本单元”由 **Cluster → Service → Task** 三层组成：

---

### Cluster（集群）

> 容器运行环境的逻辑边界。

* 是所有 ECS 工作负载（Tasks/Services）的“容器”。
* 管理计算资源（EC2 实例、Fargate、外部节点）。
* 定义了任务调度与运行的范围。

 类比：

> “集群”就像一栋大楼，所有的容器任务都在这栋楼的不同房间里运行。

---

###  Service（服务）

> 管理一组**长期运行的任务（Tasks）**，确保应用始终可用。

* 维持期望的任务数量（Desired Count）；
* 自动替换失败或停止的任务；
* 可挂接 **Elastic Load Balancer（ELB）** 进行流量分发；
* 支持 **Auto Scaling**（自动扩缩容）根据负载变化调整任务数。

 本质：

> **Service = Desired State Manager**
> 确保系统运行状态与期望状态一致。

 适用场景：Web 应用、API 服务、持久性后台任务。

---

### Task（任务）

> ECS 中的**最小运行单位**。

* 由一个 **Task Definition（任务定义）** 描述：

  * 包含容器镜像（Image）、CPU/内存、网络模式、环境变量等；
* 可以包含一个或多个容器（例如应用容器 + Sidecar 容器）；
* 任务可以：

  * 通过 **Service** 长期运行；
  * 或者作为 **独立任务（Standalone Task）** 一次性执行（类似 CronJob / Batch Job）。

---


## 七、课程小结

|       |                       |
| ---------- | ------------------------ |
| **ECS 定义** | 全托管容器编排服务                |
| **两大架构层**  | 控制平面（调度） + 数据平面（运行）      |
| **三种运行方式** | EC2、Fargate、ECS Anywhere |
| **三大核心组件** | Cluster、Service、Task     |
| **集成生态**   | 深度集成 AWS 安全、监控与存储服务      |
| **设计目标**   | 简单、高可靠、统一、灵活             |

---
ECS Task Definition
